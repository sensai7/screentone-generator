<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Screentone Generator</title>
    <link rel="stylesheet" type="text/css" href="styles.css">  </head>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

</head>
<body>
    <div class="container mt-5">
    	<div id="headerWrapper" class="d-flex justify-content-center align-items-center" >
    		<h1 class="">Screentone Generator</h1>
    	</div>
        
        <!-- Radio buttons for option selection -->
        <div class="form-group row justify-content-center text-center ">
            <div class="col-sm-2 form-check">
                <input class="form-check-input " type="radio" name="options" id="option1" value="1" onclick="refresh()" checked>
                <label class="form-check-label" for="option1">Single color</label>
            </div>
            <div class="col-sm-2 form-check">
                <input class="form-check-input" type="radio" name="options" id="option2" value="2" onclick="refresh()">
                <label class="form-check-label" for="option2">Gradient</label>
            </div>
        </div>

        <!-- Color pickers -->
        <div id="colorPickers" class="form-group row justify-content-center text-center ">
            <div class="col-sm-2 ">
                <input type="color" class="grayscale-picker form-control center-element" id="colorPicker1" style="width: 100px; height: 50px;" value="#a6a6a6" onchange="handleColorChange(this)">
                <div>Primary color</div>
            </div>
	        <div class="col-sm-1 swap-button" id="colorSwapButton">
	            <button class="btn btn-primary" onclick="swapColors()" style="margin-top: 10px;" >
	                <i class="bi bi-arrow-left-right"></i> 
	            </button>
	        </div>
            <div class="col-sm-2 " id="colorPicker2Container" >
                <input type="color" class="grayscale-picker form-control center-element" id="colorPicker2" style="width: 100px; height: 50px; margin : 0 auto;" value="#656565" onchange="handleColorChange(this)">
                <div>Secondary color</div>
            </div>
        </div>

		<!-- Gradient direction -->
		<div class="form-group row justify-content-center text-center" id="gradient-direction-container">
		    <label class="col-sm-2 col-form-label">Gradient direction</label>
		    <div class="col-sm-2 form-check d-flex align-items-center ">
		        <input class="form-check-input" type="radio" name="gradient-direction" id="vertical" value="1" onclick="refresh()" checked>
		        <label class="form-check-label" for="vertical">Vertical</label>
		    </div>
		    <div class="col-sm-2 form-check d-flex align-items-center ">
		        <input class="form-check-input" type="radio" name="gradient-direction" id="horizontal" value="2" onclick="refresh()">
		        <label class="form-check-label" for="horizontal">Horizontal</label>
		    </div>
		</div>

		<!-- Size control row -->
		<div class="form-group row justify-content-center align-items-center">
		    <label class="col-sm-2 col-form-label">Tile size</label>
		    <div class="col-sm-4 ">
		        <input type="range" class="form-control-range" id="sizeSlider" min="2" max="100" value="26" oninput="syncSliderText('size')" onchange="refresh()">
		    </div>
		    <div class="col-sm-1.5">
		        <input type="number" class="form-control" id="sizeText" min="2" max="100" value="26" oninput="syncTextSlider('size')" onchange="refresh()">
		    </div>
		    <label class="col-sm-1 col-form-label">px</label>
		</div>

		<!-- Angle control row -->
		<div class="form-group row justify-content-center align-items-center">
		    <label class="col-sm-2 col-form-label">Angle</label>
		    <div class="col-sm-4">
		        <input type="range" class="form-control-range" id="angleSlider" min="0" max="90" value="45" oninput="syncSliderText('angle')" onchange="refresh()">
		    </div>
		    <div class="col-sm-1.5">
		        <input type="number" class="form-control" id="angleText" min="0" max="90" value="45" oninput="syncTextSlider('angle')" onchange="refresh()">
		    </div>
		    <label class="col-sm-1 col-form-label">°</label>
		</div>


        <!-- Shape selection row -->
        <div class="form-group text-center">
            <label class="text-center">Basic shapes</label>
            <div class="row justify-content-center align-items-center">
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape1" value="sine-cosine" onclick="refresh()" checked>
                    <label class="form-check-label" for="shape1">
                        <img src="img/sine-cosine.png" alt="Shape 1">
                        <div>Sine-cosine</div>
                    </label>
                </div>
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape2" value="circles" onclick="refresh()">
                    <label class="form-check-label" for="shape2">
                        <img src="img/circles.png" alt="Shape 2">
                        <div>Circles</div>
                    </label>
                </div>
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape3" value="lines" onclick="refresh()">
                    <label class="form-check-label" for="shape3">
                        <img src="img/lines.png" alt="Shape 3">
                        <div>Lines</div>
                    </label>
                </div>
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape4" value="random" onclick="refresh()">
                    <label class="form-check-label" for="shape4">
                        <img src="img/random.png" alt="Shape 4">
                        <div>Random</div>
                    </label>
                </div>
            </div>
            <label class="text-center">Harmonic shapes</label>
            <div class="row justify-content-center align-items-center">
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape5" value="squares" onclick="refresh()">
                    <label class="form-check-label" for="shape5">
                        <img src="img/squares.png" alt="Shape 5">
                        <div>Squares</div>
                    </label>
                </div>
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape6" value="sparkles" onclick="refresh()">
                    <label class="form-check-label" for="shape6">
                        <img src="img/sparkles.png" alt="Shape 6">
                        <div>Sparkles</div>
                    </label>
                </div>
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape7" value="inception" onclick="refresh()">
                    <label class="form-check-label" for="shape7">
                        <img src="img/inception.png" alt="Shape 7">
                        <div>Inception</div>
                    </label>
                </div>
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="shape8" value="tartan" onclick="refresh()">
                    <label class="form-check-label" for="shape8">
                        <img src="img/tartan.png" alt="Shape 8">
                        <div>Tartan</div>
                    </label>
                </div>
            </div>

            <label class="text-center">Do It Yourself</label>
            <div class="row justify-content-center align-items-center">
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="harmonic" value="harmonic" onclick="refresh()">
                    <label class="form-check-label" for="harmonic">
                        <img src="img/arbitrary.png" alt="Shape 9">
                        <div>Harmonic</div>
                    </label>
                </div>
                <div class="col-sm-2 ">
                    <input class="form-check-input" type="radio" name="shape" id="arbitrary" value="arbitrary" onclick="refresh()" disabled>
                    <label class="form-check-label" for="arbitrary">
                        <img src="img/arbitrary.png" alt="Shape 10" class="opacity-50">
                        <div>Custom (Soon™)</div>
                    </label>
                </div>
            </div>

        </div>


        <!-- Harmonic coefficients -->
        <div class="form-group text-center" id="coef-container">
	        <label class="text-center">Harmonic coefficients</label>
	        <div class="row justify-content-center align-items-center">
	        	<label class="col-sm-smol col-form-label">1</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef1" value="1" step="0.05"  onchange="refresh()">
	            </div>
	            <label class="col-sm-smol col-form-label">2</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef2" value="0" step="0.05" onchange="refresh()">
	            </div>
	            <label class="col-sm-smol col-form-label">3</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef3" value="0" step="0.05"  onchange="refresh()">
	            </div>
	            <label class="col-sm-smol col-form-label">4</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef4" value="0" step="0.05"  onchange="refresh()">
	            </div>
	        </div>
	        <div class="row justify-content-center align-items-center">
	        	<label class="col-sm-smol col-form-label">5</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef5" value="0" step="0.05"  onchange="refresh()">
	            </div>
	            <label class="col-sm-smol col-form-label">6</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef6" value="0" step="0.05" onchange="refresh()">
	            </div>
	            <label class="col-sm-smol col-form-label">7</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef7" value="0" step="0.05"  onchange="refresh()">
	            </div>
	            <label class="col-sm-smol col-form-label">8</label>
	            <div class="col-sm-custom">
	                <input type="number" class="form-control" id="coef8" value="0" step="0.05"  onchange="refresh()">
	            </div>
	        </div>
	    </div>


        <!-- Image size control row -->
        <div class="form-group row justify-content-center">
            <label class="col-sm-2 col-form-label">Image size</label>
            <div class="col-sm-2">
                <input type="number" class="form-control" id="width" min="1" value="256" onchange="refresh()">
            </div>
            <label class="col-form-label">x</label>
            <div class="col-sm-2">
                <input type="number" class="form-control" id="height" min="1" value="256" onchange="refresh()">
            </div>
            <label class="col-form-label">px</label>
        </div>

        <div id="imgWrapper" class="d-flex justify-content-center align-items-center" ></div>

        <!-- Buttons for copy and save -->
        <div class="text-center mt-2">
            <button class="btn btn-primary mr-2" onclick="copyToClipboard()">Copy to clipboard</button>
            <button class="btn btn-success" onclick="saveImage()">Save as .png</button>
        </div>

	    <!-- Footer -->
	    <footer class="text-center mt-4 py-4">
	        <p>Made by 
	            <a href="https://x.com/GonzaloLetterer" target="_blank"> @GonzaloLetterer </a>
	        </p>
	    </footer>
    </div>

    <script src="interface.js"></script>
    <script src="screentone.js"></script>
    <script>
        function refresh() {
            const option1 = document.getElementById('option1').checked;
            const option2 = document.getElementById('option2').checked;
            var width = document.getElementById('width').value;
            var height = document.getElementById('height').value;
            const colorSwapButtonContainer = document.getElementById('colorSwapButton');
                        
			var canvas = document.createElement('canvas');
			canvas.width = width;
			canvas.height = height;
			var ctx = canvas.getContext('2d');

            if (option1) {
            	var imageData = createFlatImageData(canvas);
            } else if (option2) {
            	var imageData = createGradientImageData(canvas);
            }

            selectedShape = getSelectedShape();

            var frequency = (Math.PI * 2) / document.getElementById('sizeText').value ;
            var angle = document.getElementById('angleText').value;
            var screentoneData = applyScreentone(imageData.data, width, height, frequency, angle, selectedShape);

            // Put the screentone image data back to the canvas
            ctx.putImageData(screentoneData, 0, 0);
            var img = new Image();
            img.src = canvas.toDataURL();
            img.id
            var imgWrapper = document.getElementById('imgWrapper');
            imgWrapper.innerHTML = '';
            imgWrapper.appendChild(img);
        }

        // Initial call to setup the page
        refresh();
    </script>
</body>
</html>
